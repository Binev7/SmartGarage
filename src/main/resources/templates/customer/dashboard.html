<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Smart Garage | My Garage</title>
    <div th:replace="~{fragments/common :: header-css}"></div>
    <style>
        body { background-color: #0b0b0b; color: #ffffff; font-family: 'Inter', sans-serif; }
        .dashboard-header {
            background: linear-gradient(rgba(0,0,0,0.85), rgba(0,0,0,0.85)), url('/images/hero-bg.jpeg');
            background-size: cover; background-position: center;
            padding: 60px 0; border-bottom: 2px solid #ff6600;
        }
        .card-garage {
            background: #161616; border: 1px solid #2a2a2a; transition: 0.3s;
            box-shadow: 0 4px 20px rgba(0,0,0,0.6);
            border-radius: 0;
        }
        .card-garage:hover { border-color: #ff6600; transform: translateY(-5px); }
        .text-orange { color: #ff6600 !important; }
        .btn-orange { background-color: #ff6600; color: #000; border: none; font-weight: bold; text-transform: uppercase; border-radius: 0; }
        .btn-orange:hover { background-color: #e65c00; color: #000; }

        .vin-badge { background: #000; color: #666; font-family: monospace; padding: 5px 10px; border: 1px solid #222; }
    </style>
</head>
<body>

<div th:replace="~{fragments/common :: navbar-customer}"></div>

<header class="dashboard-header text-center">
    <div class="container mt-4">
        <h1 class="display-4 fw-bold text-uppercase">My <span class="text-orange">Garage</span></h1>
        <p class="lead text-secondary mt-2">Manage your vehicles and book professional maintenance in seconds.</p>
    </div>
</header>

<main class="container py-5">

    <div th:if="${param.success}" class="alert alert-success bg-dark text-success border-success rounded-0 mb-5 animate__animated animate__fadeInDown">
        <div class="container d-flex align-items-center">
            <i class="bi bi-check-circle-fill me-3 fs-4"></i>
            <div>
                <strong class="d-block">Success!</strong>
                <span th:if="${param.success[0] == 'visit_booked'}">Your service appointment has been reserved. Check 'History' for details.</span>
                <span th:if="${param.success[0] == 'vehicle_added'}">New vehicle has been registered to your garage.</span>
                <span th:if="${param.success[0] == 'vehicle_deleted'}">Vehicle removed successfully.</span>
                <span th:if="${param.success[0] == 'visit_cancelled'}">Appointment cancelled.</span>
            </div>
        </div>
    </div>

    <div class="row justify-content-center">
        <div class="col-lg-11">
            <div class="d-flex justify-content-between align-items-end mb-4 pb-3 border-bottom border-secondary">
                <div>
                    <h3 class="fw-bold m-0 text-uppercase">Registered <span class="text-orange">Vehicles</span></h3>
                    <p class="text-secondary small mb-0" th:text="${#lists.size(vehicles) + ' cars in your collection'}">2 cars in your collection</p>
                </div>
                <a th:href="@{/customer/vehicles/add/step1}" class="btn btn-orange px-4 py-2">
                    <i class="bi bi-plus-lg me-2"></i>Register New Car
                </a>
            </div>

            <div th:if="${vehicles.empty}" class="p-5 text-center bg-black border border-secondary my-5">
                <i class="bi bi-car-front fs-1 text-secondary mb-3 d-block"></i>
                <h4 class="text-white fw-bold">Your garage is currently empty</h4>
                <p class="text-secondary mb-4">Add your vehicle to start tracking its service history and book appointments.</p>
                <a th:href="@{/customer/vehicles/add/step1}" class="btn btn-orange px-5 py-3">Add Your First Car</a>
            </div>

            <div class="row g-4">
                <div th:each="v : ${vehicles}" class="col-md-6 col-xl-4">
                    <div class="card card-garage h-100 p-4">
                        <div class="d-flex justify-content-between align-items-start mb-4">
                            <div>
                                <h3 class="fw-bold text-white mb-0 text-uppercase" th:text="${v.brandName}">BMW</h3>
                                <div class="d-flex align-items-center gap-2 mt-1">
                                    <span class="text-orange fw-bold" th:text="${v.modelName}">M5</span>
                                    <span class="text-secondary">â€¢</span>
                                    <span class="text-white opacity-50" th:text="${v.year}">2022</span>
                                </div>
                            </div>
                            <div class="text-end">
                                <span class="badge bg-orange text-black px-3 py-2 fw-bold" th:text="${v.licensePlate}">CB1234AB</span>
                            </div>
                        </div>

                        <div class="mb-4">
                            <label class="text-secondary small text-uppercase fw-bold d-block mb-1">Identification (VIN)</label>
                            <span class="vin-badge small" th:text="${v.vin}">WBA1234567890</span>
                        </div>

                        <div class="mt-auto pt-3 border-top border-secondary d-flex gap-2">
                            <a th:href="@{/customer/visits/book/step1(vehicleId=${v.id})}" class="btn btn-orange flex-grow-1 py-2">
                                <i class="bi bi-calendar-check me-2"></i>Book Service
                            </a>
                            <a th:href="@{/customer/vehicles/details(id=${v.id})}" class="btn btn-outline-light px-3 py-2">
                                <i class="bi bi-info-circle"></i>
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</main>

<div th:replace="~{fragments/common :: footer-scripts}"></div>
</body>
</html>